// Crossword Generator using Backtracking Algorithm
const fs = require('fs');

// Word dictionaries
const dictionaries = {
    4: ["ABLE", "ACID", "AGED", "ALSO", "AREA", "ARMY", "AWAY", "BABY", "BACK", "BALL", "BAND", "BANK", "BASE", "BATH", "BEAR", "BEAT", "BEEN", "BEER", "BELL", "BELT", "BEST", "BILL", "BIRD", "BLOW", "BLUE", "BOAT", "BODY", "BOMB", "BOND", "BONE", "BOOK", "BOOM", "BORN", "BOSS", "BOTH", "BOWL", "BULK", "BURN", "BUSH", "BUSY", "CALL", "CALM", "CAME", "CAMP", "CARD", "CARE", "CASE", "CASH", "CAST", "CELL", "CHAT", "CHEF", "CHIP", "CITY", "CLUB", "COAL", "COAT", "CODE", "COLD", "COME", "COOK", "COOL", "COPE", "COPY", "CORE", "CORN", "COST", "CREW", "CROP", "DARK", "DATA", "DATE", "DAWN", "DEAD", "DEAL", "DEAN", "DEAR", "DEBT", "DEEP", "DENY", "DESK", "DIET", "DISC", "DISK", "DOES", "DONE", "DOOR", "DOSE", "DOWN", "DRAG", "DRAW", "DREW", "DROP", "DRUG", "DRUM", "DUAL", "DUCK", "DUKE", "DUST", "DUTY", "EACH", "EARL", "EARN", "EASE", "EAST", "EASY", "EDGE", "ELSE", "EVEN", "EVER", "EVIL", "EXIT", "FACE", "FACT", "FAIL", "FAIR", "FALL", "FARM", "FAST", "FATE", "FEAR", "FEED", "FEEL", "FEET", "FELL", "FELT", "FILE", "FILL", "FILM", "FIND", "FINE", "FIRE", "FIRM", "FISH", "FIVE", "FLAT", "FLED", "FLEW", "FLOW", "FOLK", "FOOD", "FOOT", "FORD", "FORM", "FORT", "FOUR", "FREE", "FROM", "FUEL", "FULL", "FUND", "GAIN", "GAME", "GATE", "GAVE", "GEAR", "GENE", "GIFT", "GIRL", "GIVE", "GLAD", "GOAL", "GOES", "GOLD", "GOLF", "GONE", "GOOD", "GRAY", "GREW", "GREY", "GRIP", "GROW", "GULF", "HAIR", "HALF", "HALL", "HAND", "HANG", "HARD", "HARM", "HATE", "HAVE", "HEAD", "HEAR", "HEAT", "HELD", "HELL", "HELP", "HERE", "HERO", "HIGH", "HILL", "HIRE", "HOLD", "HOLE", "HOME", "HOPE", "HOST", "HOUR", "HUGE", "HUNG", "HUNT", "HURT", "IDEA", "INCH", "INTO", "IRON", "ITEM", "JACK", "JANE", "JULY", "JUNE", "JURY", "JUST", "KEEP", "KENT", "KEPT", "KICK", "KILL", "KIND", "KING", "KNEE", "KNEW", "KNOW", "LACK", "LADY", "LAID", "LAKE", "LAND", "LANE", "LAST", "LATE", "LEAD", "LEFT", "LESS", "LIFE", "LIFT", "LIKE", "LINE", "LINK", "LIST", "LIVE", "LOAD", "LOAN", "LOCK", "LONG", "LOOK", "LORD", "LOSE", "LOSS", "LOST", "LOVE", "LUCK", "MADE", "MAIL", "MAIN", "MAKE", "MALE", "MALL", "MANY", "MARK", "MASS", "MATE", "MATH", "MEAL", "MEAN", "MEAT", "MEET", "MENU", "MERE", "MILE", "MILK", "MILL", "MIND", "MINE", "MISS", "MODE", "MOOD", "MOON", "MORE", "MOST", "MOVE", "MUCH", "MUST", "NAME", "NAVY", "NEAR", "NECK", "NEED", "NEWS", "NEXT", "NICE", "NICK", "NINE", "NONE", "NOON", "NORM", "NOSE", "NOTE", "OATH", "OBEY", "ODDS", "OKAY", "ONCE", "ONLY", "ONTO", "OPEN", "ORAL", "OVER", "PACE", "PACK", "PAGE", "PAID", "PAIN", "PAIR", "PALE", "PALM", "PARK", "PART", "PASS", "PAST", "PATH", "PEAK", "PICK", "PILE", "PILL", "PINE", "PINK", "PIPE", "PLAN", "PLAY", "PLOT", "PLUG", "PLUS", "POEM", "POET", "POLE", "POLL", "POND", "POOL", "POOR", "POPE", "PORK", "PORT", "POST", "POUR", "PRAY", "PREP", "PREY", "PURE", "PUSH", "RACE", "RAIL", "RAIN", "RANK", "RARE", "RATE", "READ", "REAL", "REAR", "REDS", "RELY", "RENT", "REST", "RICE", "RICH", "RIDE", "RING", "RISE", "RISK", "ROAD", "ROAM", "ROCK", "ROLE", "ROLL", "ROOF", "ROOM", "ROOT", "ROPE", "ROSE", "RULE", "RUSH", "RUTH", "SAFE", "SAID", "SAKE", "SALE", "SALT", "SAME", "SAND", "SAVE", "SEAL", "SEAT", "SEED", "SEEK", "SEEM", "SEEN", "SELF", "SELL", "SEND", "SENT", "SEPT", "SHIP", "SHOP", "SHOT", "SHOW", "SHUT", "SICK", "SIDE", "SIGN", "SILK", "SING", "SINK", "SITE", "SIZE", "SKIN", "SLIP", "SLOW", "SNOW", "SOFT", "SOIL", "SOLD", "SOLE", "SOME", "SONG", "SOON", "SORT", "SOUL", "SPOT", "STAR", "STAY", "STEP", "STOP", "SUCH", "SUIT", "SURE", "TAKE", "TALE", "TALK", "TALL", "TANK", "TAPE", "TASK", "TEAM", "TEAR", "TECH", "TELL", "TEND", "TERM", "TEST", "TEXT", "THAN", "THAT", "THEM", "THEN", "THEY", "THIN", "THIS", "THUS", "TIDE", "TIED", "TIER", "TILL", "TIME", "TINY", "TIRE", "TONE", "TOOK", "TOOL", "TORN", "TOUR", "TOWN", "TREE", "TRIP", "TRUE", "TUNE", "TURN", "TWIN", "TYPE", "UNIT", "UPON", "USED", "USER", "VARY", "VAST", "VERY", "VICE", "VIEW", "VISA", "VOTE", "WAGE", "WAIT", "WAKE", "WALK", "WALL", "WANT", "WARD", "WARM", "WARN", "WASH", "WAVE", "WAYS", "WEAK", "WEAR", "WEEK", "WELL", "WENT", "WERE", "WEST", "WHAT", "WHEN", "WHOM", "WIDE", "WIFE", "WILD", "WILL", "WIND", "WINE", "WING", "WIRE", "WISE", "WISH", "WITH", "WOOD", "WORD", "WORE", "WORK", "WORN", "YARD", "YEAH", "YEAR", "YOUR", "ZERO", "ZONE"],
    5: ["ABOUT", "ABOVE", "ABUSE", "ADMIT", "ADOPT", "ADULT", "AFTER", "AGAIN", "AGENT", "AGREE", "AHEAD", "ALARM", "ALBUM", "ALERT", "ALIEN", "ALIGN", "ALIKE", "ALIVE", "ALLOW", "ALONE", "ALONG", "ALTER", "AMBER", "AMEN", "ANGEL", "ANGER", "ANGLE", "ANGRY", "APART", "APPLE", "APPLY", "ARENA", "ARGUE", "ARISE", "AROSE", "ARRAY", "ARROW", "ASIDE", "ASSET", "AUDIO", "AVERT", "AVOID", "AWARD", "AWARE", "BADLY", "BAKER", "BASES", "BASIC", "BASIN", "BASIS", "BEACH", "BEGAN", "BEGIN", "BEING", "BELOW", "BENCH", "BILLY", "BIRTH", "BLACK", "BLADE", "BLAME", "BLANK", "BLIND", "BLOCK", "BLOOD", "BLOOM", "BOARD", "BOOST", "BOOTH", "BOUND", "BRAIN", "BRAND", "BREAD", "BREAK", "BREED", "BRIEF", "BRING", "BROAD", "BROKE", "BROWN", "BUILD", "BUILT", "BUYER", "CABLE", "CALIF", "CARRY", "CATCH", "CAUSE", "CHAIN", "CHAIR", "CHAOS", "CHARM", "CHART", "CHASE", "CHEAP", "CHECK", "CHEST", "CHIEF", "CHILD", "CHINA", "CHOSE", "CIVIL", "CLAIM", "CLASS", "CLEAN", "CLEAR", "CLICK", "CLIMB", "CLOCK", "CLOSE", "COACH", "COAST", "COULD", "COUNT", "COURT", "COVER", "CRAFT", "CRASH", "CRAZY", "CREAM", "CRIME", "CROSS", "CROWD", "CROWN", "CRUDE", "CURVE", "CYCLE", "DAILY", "DANCE", "DATED", "DEALT", "DEATH", "DEBUT", "DELAY", "DELTA", "DENSE", "DEPTH", "DOING", "DOUBT", "DOZEN", "DRAFT", "DRAMA", "DRANK", "DRAWN", "DREAM", "DRESS", "DRILL", "DRINK", "DRIVE", "DROVE", "DYING", "EAGER", "EARLY", "EARTH", "EATER", "EIGHT", "ELECT", "ELITE", "EMBER", "EMPTY", "ENEMY", "ENJOY", "ENTER", "ENTRY", "EQUAL", "ERROR", "ESSAY", "EVENT", "EVERY", "EXACT", "EXIST", "EXTRA", "FAITH", "FALSE", "FAULT", "FENCE", "FIBER", "FIELD", "FIFTH", "FIFTY", "FIGHT", "FINAL", "FIRST", "FIXED", "FLASH", "FLEET", "FLOOR", "FLUID", "FOCUS", "FORCE", "FORTH", "FORTY", "FORUM", "FOUND", "FRAME", "FRANK", "FRAUD", "FRESH", "FRONT", "FRUIT", "FULLY", "FUNNY", "GIANT", "GIVEN", "GLASS", "GLOBE", "GOING", "GRACE", "GRADE", "GRAND", "GRANT", "GRASS", "GRAVE", "GREAT", "GREEN", "GROSS", "GROUP", "GROWN", "GUARD", "GUESS", "GUEST", "GUIDE", "GUILD", "HAPPY", "HARRY", "HARSH", "HEART", "HEAVY", "HENCE", "HENRY", "HORSE", "HOTEL", "HOUSE", "HUMAN", "IDEAL", "IMAGE", "INDEX", "INNER", "INPUT", "ISSUE", "JAPAN", "JIMMY", "JOINT", "JONES", "JUDGE", "KNOWN", "LABEL", "LARGE", "LASER", "LATER", "LAUGH", "LAYER", "LEARN", "LEASE", "LEAST", "LEAVE", "LEGAL", "LEMON", "LEVEL", "LEWIS", "LIGHT", "LIMIT", "LINKS", "LIVED", "LOCAL", "LOGIC", "LOOSE", "LOWER", "LUCKY", "LUNCH", "LYING", "MAGIC", "MAJOR", "MAKER", "MARCH", "MARIA", "MATCH", "MAYBE", "MAYOR", "MEANT", "MEDIA", "METAL", "MIGHT", "MINOR", "MINUS", "MIXED", "MODEL", "MONEY", "MONTH", "MORAL", "MOTOR", "MOUNT", "MOUSE", "MOUTH", "MOVED", "MOVIE", "MUSIC", "NEEDS", "NEVER", "NEWLY", "NIGHT", "NOBLE", "NOISE", "NORTH", "NOTED", "NOVEL", "NURSE", "OCCUR", "OCEAN", "OFFER", "OFTEN", "ORDER", "OTHER", "OUGHT", "PAINT", "PANEL", "PANIC", "PAPER", "PARTY", "PEACE", "PETER", "PHASE", "PHONE", "PHOTO", "PIANO", "PIECE", "PILOT", "PITCH", "PLACE", "PLAIN", "PLANE", "PLANT", "PLATE", "POINT", "POUND", "POWER", "PRESS", "PRICE", "PRIDE", "PRIME", "PRINT", "PRIOR", "PRIZE", "PROOF", "PROUD", "PROVE", "QUEEN", "QUERY", "QUEST", "QUICK", "QUIET", "QUITE", "RADIO", "RAISE", "RANGE", "RAPID", "RATIO", "REACH", "READY", "REAPS", "REFER", "RIGHT", "RIVAL", "RIVER", "ROBIN", "ROGER", "ROMAN", "ROOST", "ROUGH", "ROUND", "ROUTE", "ROYAL", "RURAL", "SCALE", "SCENE", "SCOPE", "SCORE", "SENSE", "SERVE", "SEVEN", "SHALL", "SHAPE", "SHARE", "SHARP", "SHEET", "SHELF", "SHELL", "SHIFT", "SHINE", "SHIRT", "SHOCK", "SHOOT", "SHORT", "SHOWN", "SIGHT", "SINCE", "SIXTH", "SIZED", "SKILL", "SLEEP", "SLIDE", "SMALL", "SMART", "SMILE", "SMITH", "SMOKE", "SOLID", "SOLVE", "SORRY", "SOUND", "SOUTH", "SPACE", "SPARE", "SPEAK", "SPEED", "SPEND", "SPENT", "SPLIT", "SPOKE", "SPORT", "STAFF", "STAGE", "STAKE", "STAND", "START", "STATE", "STEAM", "STEEL", "STEEP", "STICK", "STILL", "STOCK", "STONE", "STOOD", "STORE", "STORM", "STORY", "STRIP", "STUCK", "STUDY", "STUFF", "STYLE", "SUGAR", "SUITE", "SUNNY", "SUPER", "SWEET", "TABLE", "TAKEN", "TASTE", "TAXES", "TEACH", "TERRY", "TEXAS", "THANK", "THEFT", "THEIR", "THEME", "THERE", "THESE", "THICK", "THING", "THINK", "THIRD", "THOSE", "THREE", "THREW", "THROW", "TIGHT", "TIMES", "TITLE", "TODAY", "TOPIC", "TOTAL", "TOUCH", "TOUGH", "TOWER", "TRACK", "TRADE", "TRAIL", "TRAIN", "TRAIT", "TREAT", "TREND", "TRIAL", "TRIBE", "TRICK", "TRIED", "TROOP", "TRUCK", "TRULY", "TRUNK", "TRUST", "TRUTH", "TWICE", "UNDER", "UNDUE", "UNION", "UNITY", "UNTIL", "UPPER", "UPSET", "URBAN", "USAGE", "USUAL", "VALID", "VALUE", "VIDEO", "VIRUS", "VISIT", "VITAL", "VOCAL", "VOICE", "WASTE", "WATCH", "WATER", "WHEEL", "WHERE", "WHICH", "WHILE", "WHITE", "WHOLE", "WHOSE", "WOMAN", "WOMEN", "WORLD", "WORRY", "WORSE", "WORST", "WORTH", "WOULD", "WOUND", "WRITE", "WRONG", "WROTE", "YIELD", "YOUNG", "YOUTH"],
    6: ["ACCEPT", "ACCESS", "ACROSS", "ACTION", "ACTUAL", "ADVICE", "AFFAIR", "AFFECT", "AFFORD", "AFRAID", "AGENCY", "AGENDA", "ALMOST", "ALWAYS", "AMOUNT", "ANIMAL", "ANNUAL", "ANSWER", "ANYONE", "ANYWAY", "APPEAL", "APPEAR", "AROUND", "ARRIVE", "ARTIST", "ASPECT", "ASSIGN", "ASSIST", "ASSUME", "ATTACK", "ATTEND", "AUGUST", "AUTHOR", "AVENUE", "BACKED", "BARELY", "BARREL", "BASKET", "BATTLE", "BEAUTY", "BECAME", "BECOME", "BEFORE", "BEHALF", "BEHIND", "BELIEF", "BELONG", "BESIDE", "BETTER", "BEYOND", "BISHOP", "BORDER", "BOTTLE", "BOTTOM", "BRANCH", "BREATH", "BRIDGE", "BRIGHT", "BROKEN", "BUDGET", "BURDEN", "BUREAU", "BUTTON", "CAMERA", "CANCER", "CANNOT", "CARBON", "CAREER", "CASTLE", "CASUAL", "CAUGHT", "CENTER", "CENTRE", "CHANCE", "CHANGE", "CHARGE", "CHOICE", "CHOOSE", "CHOSEN", "CHURCH", "CIRCLE", "CLIENT", "CLOSED", "CLOSER", "COFFEE", "COLUMN", "COMBAT", "COMMON", "COMPLY", "COPPER", "CORNER", "COSTLY", "COUNTY", "COUPLE", "COURSE", "COVERS", "CREATE", "CREDIT", "CRISIS", "CUSTOM", "DAMAGE", "DANGER", "DEALER", "DEBATE", "DECADE", "DECIDE", "DEFEAT", "DEFEND", "DEFINE", "DEGREE", "DEMAND", "DEPEND", "DEPUTY", "DERIVE", "DESIGN", "DESIRE", "DETAIL", "DETECT", "DEVICE", "DIFFER", "DINNER", "DIRECT", "DOCTOR", "DOLLAR", "DOMAIN", "DOUBLE", "DRIVEN", "DRIVER", "DURING", "EASILY", "EATING", "EDITOR", "EFFECT", "EFFORT", "EIGHTH", "EITHER", "ELEVEN", "EMERGE", "EMPIRE", "EMPLOY", "ENABLE", "ENDING", "ENERGY", "ENGAGE", "ENGINE", "ENOUGH", "ENSURE", "ENTIRE", "ENTITY", "EQUITY", "ESCAPE", "ESTATE", "ETHNIC", "EUROPE", "EXCESS", "EXPAND", "EXPECT", "EXPERT", "EXPORT", "EXTEND", "EXTENT", "FABRIC", "FACIAL", "FACTOR", "FAILED", "FAIRLY", "FALLEN", "FAMILY", "FAMOUS", "FATHER", "FELLOW", "FEMALE", "FIGURE", "FILING", "FINGER", "FINISH", "FISCAL", "FLIGHT", "FLYING", "FOLLOW", "FORCED", "FOREST", "FORGET", "FORMAL", "FORMAT", "FORMER", "FOSTER", "FOUGHT", "FOURTH", "FRENCH", "FRIEND", "FUTURE", "GARDEN", "GATHER", "GENDER", "GERMAN", "GLOBAL", "GOLDEN", "GROUND", "GROWTH", "GUILTY", "HANDED", "HANDLE", "HAPPEN", "HARDLY", "HEADED", "HEALTH", "HEAVEN", "HEIGHT", "HIDDEN", "HIGHLY", "HOLDER", "HONEST", "IMPACT", "IMPORT", "IMPOSE", "INCOME", "INDEED", "INJURY", "INSIDE", "INTEND", "INTENT", "INVEST", "ISLAND", "ITSELF", "JERSEY", "JOSEPH", "JUNIOR", "KILLED", "LABOUR", "LATEST", "LATTER", "LAUNCH", "LAWYER", "LEADER", "LEAGUE", "LEAVES", "LEGACY", "LENGTH", "LESSON", "LETTER", "LIGHTS", "LIKELY", "LINKED", "LIQUID", "LISTEN", "LITTLE", "LIVING", "LOSING", "LOVELY", "LUXURY", "MAINLY", "MAKING", "MANAGE", "MANNER", "MANUAL", "MARGIN", "MARINE", "MARKED", "MARKET", "MASTER", "MATTER", "MATURE", "MEDIUM", "MEMBER", "MEMORY", "MENTAL", "MERELY", "MERGER", "METHOD", "MIDDLE", "MILLER", "MINUTE", "MIRROR", "MOBILE", "MODERN", "MODEST", "MODIFY", "MODULE", "MOMENT", "MORRIS", "MOSTLY", "MOTHER", "MOTION", "MOVING", "MURDER", "MUSEUM", "MUTUAL", "MYSELF", "NARROW", "NATION", "NATIVE", "NATURE", "NEARBY", "NEARLY", "NEEDLE", "NOTICE", "NOTION", "NUMBER", "OBJECT", "OBTAIN", "OFFICE", "ONLINE", "OPTION", "ORANGE", "ORIGIN", "OUTPUT", "OXFORD", "PACKED", "PALACE", "PARENT", "PARTLY", "PASSED", "PATENT", "PERIOD", "PERMIT", "PERSON", "PHRASE", "PICKED", "PLANET", "PLAYER", "PLEASE", "PLENTY", "POCKET", "POLICE", "POLICY", "PREFER", "PRETTY", "PRIEST", "PRINCE", "PRISON", "PROFIT", "PROPER", "PROVEN", "PUBLIC", "PURSUE", "RAISED", "RANDOM", "RARELY", "RATHER", "RATING", "READER", "REALLY", "REASON", "RECALL", "RECENT", "RECORD", "REDUCE", "REFORM", "REFUSE", "REGARD", "REGIME", "REGION", "RELATE", "RELIEF", "REMAIN", "REMARK", "REMOTE", "REMOVE", "RENDER", "REPAIR", "REPEAT", "REPORT", "RESORT", "RESULT", "RETAIN", "RETURN", "REVEAL", "REVIEW", "REWARD", "RIDING", "RISING", "ROBUST", "RULING", "SAFETY", "SALARY", "SAMPLE", "SAVING", "SAYING", "SCHEME", "SCHOOL", "SCREEN", "SEARCH", "SEASON", "SECOND", "SECRET", "SECTOR", "SECURE", "SEEING", "SELECT", "SELLER", "SENIOR", "SERIES", "SERVED", "SETTLE", "SEVERE", "SEXUAL", "SHOULD", "SIGNAL", "SIGNED", "SILENT", "SILVER", "SIMPLE", "SIMPLY", "SINGLE", "SISTER", "SLIGHT", "SMOOTH", "SOCIAL", "SOLELY", "SOUGHT", "SOURCE", "SOVIET", "SPEECH", "SPIRIT", "SPOKEN", "SPREAD", "SPRING", "SQUARE", "STABLE", "STATUS", "STEADY", "STOLEN", "STRAIN", "STRAND", "STREAM", "STREET", "STRESS", "STRICT", "STRIKE", "STRING", "STRONG", "STRUCK", "STUDIO", "SUBMIT", "SUDDEN", "SUFFER", "SUMMER", "SUMMIT", "SUPPLY", "SURELY", "SURVEY", "SWITCH", "SYMBOL", "SYSTEM", "TAKING", "TALENT", "TARGET", "TAUGHT", "TEMPLE", "TENANT", "TENNIS", "THANKS", "THEORY", "THIRTY", "THOUGH", "THREAT", "THROWN", "TICKET", "TIMELY", "TIMING", "TISSUE", "TOWARD", "TRADER", "TRAVEL", "TREATY", "TRYING", "TUNNEL", "TURNED", "TWELVE", "TWENTY", "UNABLE", "UNIQUE", "UNITED", "UNLIKE", "USEFUL", "VALLEY", "VARIED", "VENDOR", "VERSUS", "VESSEL", "VICTIM", "VISION", "VISUAL", "VOLUME", "WALKER", "WEALTH", "WEAPON", "WEEKLY", "WEIGHT", "WHOLLY", "WINDOW", "WINNER", "WINTER", "WITHIN", "WONDER", "WORKER", "WORTHY", "WRITER", "YELLOW"],
    7: ["ABILITY", "ABSENCE", "ACADEMY", "ACCOUNT", "ACCUSED", "ACHIEVE", "ACQUIRE", "ADDRESS", "ADVANCE", "ADVERSE", "ADVISED", "ADVISER", "AGAINST", "AIRPORT", "ALCOHOL", "ALLEGED", "ALREADY", "ANALYST", "ANCIENT", "ANOTHER", "ANXIETY", "ANYBODY", "APPLIED", "APPOINT", "APPROVE", "ARRANGE", "ARRIVAL", "ARTICLE", "ASSAULT", "ASSUMED", "ATTEMPT", "ATTRACT", "AVERAGE", "BACKING", "BALANCE", "BANKING", "BARRIER", "BATTERY", "BEARING", "BEATING", "BECAUSE", "BEDROOM", "BELIEVE", "BENEATH", "BENEFIT", "BESIDES", "BETWEEN", "BILLION", "BINDING", "BROTHER", "BROUGHT", "BURNING", "CABINET", "CALLING", "CAPABLE", "CAPITAL", "CAPTAIN", "CAPTURE", "CAREFUL", "CARRIER", "CENTRAL", "CENTURY", "CERTAIN", "CHAMBER", "CHANNEL", "CHAPTER", "CHARITY", "CHARLIE", "CHARTER", "CHICKEN", "CIRCUIT", "CITIZEN", "CLASSIC", "CLIMATE", "CLOSING", "CLOSURE", "CLOTHES", "COLLECT", "COLLEGE", "COMBINE", "COMFORT", "COMMAND", "COMMENT", "COMPANY", "COMPARE", "COMPETE", "COMPLEX", "CONCEPT", "CONCERN", "CONCERT", "CONDUCT", "CONFIRM", "CONNECT", "CONSENT", "CONSIST", "CONTACT", "CONTAIN", "CONTENT", "CONTEST", "CONTEXT", "CONTROL", "CONVERT", "CORRECT", "COUNCIL", "COUNSEL", "COUNTER", "COUNTRY", "COURAGE", "CRICKET", "CRUCIAL", "CRYSTAL", "CULTURE", "CURRENT", "CUSTODY", "CUTTING", "DEALING", "DECLINE", "DEFAULT", "DEFENCE", "DEFICIT", "DELIVER", "DENSITY", "DEPOSIT", "DESKTOP", "DESPITE", "DESTROY", "DEVELOP", "DIGITAL", "DISEASE", "DISPLAY", "DISPUTE", "DISTANT", "DIVORCE", "DRAWING", "DRESSED", "DRIVING", "EASTERN", "ECONOMY", "EDITION", "ELDERLY", "ELEMENT", "EMBRACE", "EMERGED", "EMOTION", "EMPEROR", "EMPIRE", "ENGAGED", "ENHANCE", "ENQUIRY", "EPISODE", "EQUALLY", "EVENING", "EVIDENT", "EXACTLY", "EXAMINE", "EXAMPLE", "EXCITED", "EXCLUDE", "EXHIBIT", "EXPENSE", "EXPLAIN", "EXPLODE", "EXPLOIT", "EXPLORE", "EXPOSED", "EXPRESS", "EXTREME", "FACTORY", "FACULTY", "FAILING", "FAILURE", "FALLING", "FASHION", "FEATURE", "FEDERAL", "FEELING", "FICTION", "FIFTEEN", "FIGHTER", "FINANCE", "FINDING", "FITNESS", "FOREIGN", "FOREVER", "FORMULA", "FORTUNE", "FORWARD", "FOUNDER", "FREEDOM", "FREIGHT", "GALLERY", "GENERAL", "GENETIC", "GENUINE", "GESTURE", "GLASGOW", "GLIMPSE", "GRAMMAR", "GRAPHIC", "GREATER", "GREATLY", "HANGING", "HEADING", "HEALTHY", "HEARING", "HEAVILY", "HELPFUL", "HERSELF", "HIGHWAY", "HIMSELF", "HISTORY", "HOLDING", "HOLIDAY", "HOPEFUL", "HORIZON", "HOUSING", "HOWEVER", "HUNDRED", "HUSBAND", "ILLEGAL", "ILLNESS", "IMAGINE", "IMPROVE", "INCLUDE", "INITIAL", "INQUIRY", "INSIGHT", "INSPIRE", "INSTALL", "INSTANT", "INSTEAD", "INTEND", "INTENSE", "INTERIM", "INVOLVE", "ISLAMIC", "JANUARY", "JOINTLY", "JOURNAL", "JOURNEY", "JUSTICE", "JUSTIFY", "KEEPING", "KITCHEN", "KINGDOM", "LANDING", "LARGELY", "LASTING", "LEADING", "LEARNED", "LEATHER", "LEAVING", "LECTURE", "LEISURE", "LIBERAL", "LIBERTY", "LIBRARY", "LICENSE", "LIMITED", "LISTING", "LOCATED", "LOGICAL", "LOOKING", "MACHINE", "MANAGER", "MARRIED", "MASSIVE", "MAXIMUM", "MEANING", "MEASURE", "MEDICAL", "MEETING", "MENTION", "MESSAGE", "MILLION", "MINERAL", "MINIMAL", "MINIMUM", "MISSING", "MISSION", "MISTAKE", "MIXTURE", "MODERATE", "MONARCH", "MONITOR", "MORNING", "MUSICAL", "MYSTERY", "NATURAL", "NEAREST", "NEITHER", "NETWORK", "NEUTRAL", "NOTHING", "NUCLEAR", "OBVIOUS", "OCTOBER", "OFFENCE", "OFFENSE", "OFFICER", "ONGOING", "OPENING", "OPERATE", "OPINION", "OUTCOME", "OUTDOOR", "OUTLINE", "OUTSIDE", "OVERALL", "PACKAGE", "PAINTED", "PARKING", "PARTIAL", "PARTNER", "PASSAGE", "PASSING", "PASSION", "PASSIVE", "PATIENT", "PATTERN", "PAYMENT", "PENALTY", "PENSION", "PERCENT", "PERFECT", "PERFORM", "PERHAPS", "PERSIST", "PICTURE", "PIONEER", "PLANNED", "PLASTIC", "PLEASED", "PLEASURE", "POINTED", "POPULAR", "POVERTY", "PRACTICE", "PRECISE", "PREDICT", "PREMIER", "PREMIUM", "PREPARE", "PRESENT", "PREVENT", "PREVIOUS", "PRIMARY", "PRINTED", "PRIVACY", "PRIVATE", "PROBLEM", "PROCEED", "PROCESS", "PRODUCE", "PRODUCT", "PROFILE", "PROGRAM", "PROJECT", "PROMISE", "PROMOTE", "PROTECT", "PROTEIN", "PROTEST", "PROVIDE", "PUBLISH", "PURPOSE", "QUALIFY", "QUALITY", "QUARTER", "RADICAL", "RAILWAY", "RAINBOW", "RAISING", "RANKING", "RAPIDLY", "READILY", "READING", "REALITY", "REALIZE", "RECEIPT", "RECEIVE", "RECOVER", "REDUCED", "REFLECT", "REFUGEE", "REFUSAL", "REGULAR", "RELATED", "RELEASE", "RELEVANT", "REMOVAL", "REPLACE", "REQUEST", "REQUIRE", "RESCUE", "RESERVE", "RESIDENT", "RESPECT", "RESPOND", "RESTORE", "RETIRED", "RETREAT", "REVENUE", "REVERSE", "REVISED", "ROUTINE", "RUNNING", "SATISFY", "SCHOLAR", "SCIENCE", "SCRATCH", "SECTION", "SEGMENT", "SELLING", "SERIOUS", "SERVANT", "SERVICE", "SESSION", "SETTING", "SEVERAL", "SHELTER", "SHORTLY", "SHOWING", "SILENCE", "SIMILAR", "SITTING", "SIXTEEN", "SKILLED", "SLAVERY", "SMOKING", "SOCIETY", "SOLDIER", "SOMEHOW", "SOMEONE", "SOUTHERN", "SPEAKER", "SPECIAL", "SPECIES", "SPONSOR", "STADIUM", "STATION", "STATUTE", "STORAGE", "STRANGE", "STRETCH", "STUDENT", "STUDIED", "SUBJECT", "SUCCESS", "SUCCEED", "SUGGEST", "SUMMARY", "SUPPORT", "SUPPOSE", "SUPREME", "SURFACE", "SURGERY", "SURPLUS", "SURVIVE", "SUSPECT", "SUSTAIN", "TALKING", "TEACHER", "TENSION", "TESTING", "THEATRE", "THERAPY", "THEREBY", "THOUGHT", "THROUGH", "TONIGHT", "TOTALLY", "TOUCHED", "TOWARDS", "TRADING", "TRAFFIC", "TRAGEDY", "TRAINED", "TRANSIT", "TREATED", "TRIUMPH", "TROUBLE", "TYPICAL", "UNIFORM", "UNKNOWN", "UNUSUAL", "UPGRADE", "UTILITY", "VARIETY", "VARIOUS", "VEHICLE", "VERSION", "VETERAN", "VICTORY", "VILLAGE", "VIOLENT", "VIRTUAL", "VISIBLE", "VISITOR", "WAITING", "WALKING", "WANTING", "WARNING", "WARRIOR", "WEALTHY", "WEARING", "WEATHER", "WEBSITE", "WEDDING", "WEEKEND", "WELCOME", "WELFARE", "WESTERN", "WHETHER", "WILLING", "WINNING", "WITHOUT", "WITNESS", "WORKING", "WORRIED", "WORSHIP", "WRITING", "WRITTEN", "YOUNGER"]
};

// Build prefix sets
function buildPrefixSet(words) {
    const prefixes = new Set();
    for (const word of words) {
        for (let i = 1; i <= word.length; i++) {
            prefixes.add(word.substring(0, i));
        }
    }
    return prefixes;
}

// Generate crossword using backtracking
function generateCrossword(n, maxAttempts = 10000) {
    const words = dictionaries[n];
    const wordSet = new Set(words);
    const prefixes = buildPrefixSet(words);
    const grid = [];
    let attempts = 0;

    function getColumn(col) {
        let result = "";
        for (let r = 0; r < grid.length; r++) {
            result += grid[r][col];
        }
        return result;
    }

    function isValidPlacement(word) {
        for (let col = 0; col < n; col++) {
            const columnSoFar = getColumn(col) + word[col];
            if (!prefixes.has(columnSoFar)) {
                return false;
            }
        }
        return true;
    }

    function backtrack(row) {
        attempts++;
        if (attempts > maxAttempts) {
            return false;
        }

        if (row === n) {
            // Check if all columns are valid words
            for (let col = 0; col < n; col++) {
                const column = getColumn(col);
                if (!wordSet.has(column)) {
                    return false;
                }
            }
            return true;
        }

        // Shuffle words for variety
        const shuffled = [...words].sort(() => Math.random() - 0.5);

        for (const word of shuffled) {
            if (isValidPlacement(word)) {
                grid.push(word);
                if (backtrack(row + 1)) {
                    return true;
                }
                grid.pop();
            }
        }
        return false;
    }

    const success = backtrack(0);
    return success ? grid : null;
}

// Generate puzzles
console.log("Generating crosswords...\n");

const results = {};
for (const size of [4, 5, 6, 7]) {
    console.log(`Generating ${size}x${size}...`);
    let grid = null;
    let attempt = 0;
    const maxTries = size >= 6 ? 5 : 1; // Try multiple times for harder puzzles

    while (!grid && attempt < maxTries) {
        attempt++;
        if (attempt > 1) console.log(`  Attempt ${attempt}/${maxTries}...`);
        grid = generateCrossword(size, size === 6 ? 200000 : size === 7 ? 500000 : 10000);
    }

    if (grid) {
        results[size] = grid;
        console.log(`✓ Success!`);
        console.log(grid.join('\n'));
        console.log();
    } else {
        console.log(`✗ Failed to generate ${size}x${size} after ${maxTries} attempts`);
    }
}

// Output results
fs.writeFileSync('crossword-results.json', JSON.stringify(results, null, 2));
console.log("\nResults saved to crossword-results.json");
